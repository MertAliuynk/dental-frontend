import React, { useRef } from "react";

export default function MilkTeethSvg({ 
  onSelect, 
  onIndividualSelect 
}: { 
  onSelect?: (selected: string[]) => void;
  onIndividualSelect?: () => void;
}) {
  // Seçili dişlerin id'lerini tutan dizi
  const selectedTeeth = useRef<string[]>([]);

  // Diş seçme fonksiyonu (kırmızıya boyar, tekrar tıklanırsa beyaza döner)
  const handleToothClick = (e: React.MouseEvent<SVGPathElement, MouseEvent>) => {
    const path = e.currentTarget;
    
    // Tıklanan path'in ait olduğu üst g (diş grubu) elementini bul
    const toothGroup = path.closest("g");
    if (!toothGroup) return;
    const toothId = toothGroup.id;
    
    // O gruptaki tüm path'leri bul
    const allPaths = toothGroup.querySelectorAll("path");
    const toothNumber = toothGroup.querySelector("text") as SVGTextElement | null;
    
    // İlk path'in mevcut fill rengine bak
    const currentFill = path.getAttribute("fill") || window.getComputedStyle(path).fill;
    const isRed = currentFill === "rgb(255, 0, 0)" || currentFill === "#ff0000" || currentFill === "#FF0000" || currentFill === "red";
    
    // Tüm path'lerin rengini değiştir
    allPaths.forEach((p: any) => {
      if (isRed) {
        p.setAttribute("fill", "none");
        p.style.fill = "none";
      } else {
        p.setAttribute("fill", "#FF0000");
        p.style.fill = "#FF0000";
      }
    });
    
    // Numara rengini değiştir
    if (toothNumber) {
      if (isRed) {
        toothNumber.setAttribute("fill", "#000");
      } else {
        toothNumber.setAttribute("fill", "#FF0000");
      }
    }
    
    // Seçili dişler dizisini güncelle
    if (isRed) {
      // Kırmızıdan beyaza döndü, diziden çıkar
      selectedTeeth.current = selectedTeeth.current.filter((id) => id !== toothId);
    } else {
      // Beyazdan kırmızıya döndü, diziye ekle (tekrar eklenmesin)
      if (!selectedTeeth.current.includes(toothId)) {
        selectedTeeth.current.push(toothId);
      }
    }
    
    // Parent componentten gelen callback'i çağır
    if (onSelect) onSelect([...selectedTeeth.current]);
    
    // Bireysel seçim yapıldığında çene seçimlerini sıfırla
    if (onIndividualSelect) onIndividualSelect();
    
    // Konsola yazdır (debug için)
    console.log("Seçili süt dişi sayısı:", selectedTeeth.current.length);
    console.log("Seçili süt dişleri:", selectedTeeth.current);
  };

  return (
    <div style={{ width: "100%", maxWidth: 400, margin: "0 auto", overflowX: "auto" }}>
      <svg 
        xmlns="http://www.w3.org/2000/svg" 
        version="1.1" 
        width="289.61084" 
        height="370.54398"
        viewBox="0 0 289.61084 370.54398"
        style={{
          overflow: "visible",
          width: "100%",
          height: "auto",
          maxWidth: "100%",
          display: "block"
        }}
      >
        <title>Süt Dişleri</title>
        
        {/* Arka plan */}
        <rect x="0" y="0" width="100%" height="100%" fill="#f2f2f2" />
        
        {/* CSS Stilleri */}
        <style>
          {`
            .milk-tooth-group {
              cursor: pointer;
            }
            .milk-tooth-group:hover path {
              stroke-width: 2;
            }
            .milk-tooth-group path {
              fill: none;
              stroke: #000000;
              stroke-width: 1;
              stroke-linecap: round;
              stroke-linejoin: miter;
              stroke-miterlimit: 4;
              stroke-opacity: 1;
              stroke-dasharray: none;
            }
            .milk-tooth-group text {
              font-size: 10px;
              font-family: Sans;
              fill: #000000;
              text-anchor: middle;
            }
          `}
        </style>

        {/* Diş 51 - Üst çene ön orta */}
        <g id="milk-tooth-51" className="milk-tooth-group">
          <path
            onClick={handleToothClick}
            d="m 124.82021,113.33987 c 0.0372,0.31136 2.03838,3.51786 2.54294,4.9663 0.6822,1.56367 1.76853,2.97726 4.66113,3.72006 2.36193,-0.26358 4.75744,-0.31994 6.74559,-2.88856 l 4.88802,-6.73611 0.89133,-2.14285 c 0.64364,-1.54722 -0.75021,-2.96997 -2.05513,-3.57982 l -3.5383,-0.85742 c -2.0666,-0.1203 -3.43827,-0.67078 -7.47617,0.42903 l -3.78887,0.7507 c -1.37832,0.55227 -3.21888,0.3361 -3.25466,3.12031 0.0725,1.06423 -0.38632,2.04669 0.38412,3.21836 z"
          />
          <path
            onClick={handleToothClick}
            d="m 128.44747,117.45968 -0.86624,-6.57101 c 0.46983,0 -0.52869,-1.32654 1.23491,-1.91862 6.44042,-2.27899 10.16234,-0.60845 11.21278,-0.10742 1.05044,0.50107 1.96238,1.87137 1.76084,3.31101 -0.20149,1.43962 -0.64251,1.78532 -0.94153,2.50024"
          />
          <text x="133" y="105">51</text>
        </g>

        {/* Diş 52 - Üst çene ön yan */}
        <g id="milk-tooth-52" className="milk-tooth-group">
          <path
            onClick={handleToothClick}
            d="m 110.54038,116.16246 c 7.26885,-5.12134 5.77969,-3.6265 8.89074,-4.76501 1.08442,-0.41599 1.98459,-0.47815 2.44213,0.30939 l 1.68688,1.81986 c 1.14633,1.54619 1.07002,1.87443 1.21553,2.42363 0.54002,4.781 -0.0841,4.72099 -0.20441,6.75586 -0.83124,1.73196 -1.83506,3.27773 -3.53342,4.07416 -1.04808,0.79357 -2.49943,0.71568 -4.04124,0.44247 l -2.53533,-0.66262 c -0.994,0.16044 -1.85046,-0.55112 -2.72196,-1.16735 -1.83919,-1.38559 -2.3145,-3.35226 -2.94688,-5.25208 -0.1272,-1.22877 0.19854,-2.31724 0.94759,-3.27469 z"
          />
          <path
            onClick={handleToothClick}
            d="m 112.58627,124.84061 c -0.97564,-1.62832 -2.53749,-2.94419 -0.64278,-6.10275 1.73794,-1.45551 3.09805,-1.90477 4.61068,-2.76021 1.30209,-0.7035 2.59424,-1.38589 3.52665,-1.30102 3.8828,-0.40005 2.28421,0.59546 3.3333,0.91692"
          />
          <text x="115" y="108">52</text>
        </g>

        {/* Diş 53 - Üst çene köpek dişi */}
        <g id="milk-tooth-53" className="milk-tooth-group">
          <path
            onClick={handleToothClick}
            d="m 103.01062,138.38843 c -3.08304,-0.93467 -4.526843,-2.64459 -4.854532,-4.88241 -0.380883,-2.18802 0.04,-4.32209 1.493748,-6.38662 1.271494,-3.21518 2.533244,-3.03715 3.796044,-3.25309 1.12646,0.12908 2.15034,0.0704 3.14749,-0.0374 3.01396,-0.12134 4.13666,1.12068 4.86298,1.9331 2.54325,3.09457 2.26243,4.89771 2.88096,7.11205 0.31819,2.44502 0.1778,4.53569 -1.19659,5.67236 -4.18183,2.84207 -4.89268,1.4495 -6.64278,1.32478 -3.25902,-1.24726 -2.42079,-1.02305 -3.48732,-1.48294 z"
          />
          <text x="105" y="125">53</text>
        </g>

        {/* Diş 54 - Üst çene 1. azı */}
        <g id="milk-tooth-54" className="milk-tooth-group">
          <path
            onClick={handleToothClick}
            d="m 89.282654,139.5966 c 5.648888,-4.45518 9.813436,-1.88186 13.978216,0.69037 1.12472,1.26818 2.22491,2.53628 3.76531,3.80542 4.71702,4.11931 3.8298,6.91486 1.09811,9.27483 -1.70251,1.71634 -3.33311,3.4002 -4.19163,4.7356 -0.98399,0.92064 -1.88868,1.62688 -2.65708,1.96492 -3.636271,1.48371 -5.024579,-0.58561 -7.06579,-1.623 -7.33366,-3.51233 -9.959925,-8.40502 -8.072869,-14.62108 0.207935,-2.3965 1.448348,-3.58013 3.145733,-4.22706 z"
          />
          <text x="95" y="135">54</text>
        </g>

        {/* Diş 55 - Üst çene 2. azı */}
        <g id="milk-tooth-55" className="milk-tooth-group">
          <path
            onClick={handleToothClick}
            d="m 69.51731,158.11451 c 5.91113,-2.30027 7.87074,-1.98736 11.89563,-0.98768 l 6.73509,2.38655 c 0.95075,0.39286 1.8836,0.50769 2.51156,1.16735 2.14779,1.24734 2.9142,2.20877 3.52665,3.42845 1.3686,3.82974 0.15838,4.68516 -0.27605,6.46692 l -2.00438,3.25309 c -0.69847,1.17167 -1.08442,2.20877 -1.9331,3.25309 -1.30209,1.60263 -2.3145,3.35226 -4.66113,3.61584 -1.77519,0.2021 -3.74017,-0.13748 -5.5858,-0.27605 l -5.24602,-2.10998 c -3.16502,-1.56367 -4.13666,-3.09457 -4.52203,-6.32607 -0.38593,-3.23151 0.66993,-5.80335 2.51156,-7.38822 1.84162,-1.58487 3.74017,-2.44502 5.99735,-2.79299 0.88574,-0.13748 2.3145,-0.34497 2.79299,-1.40895 z"
          />
          <text x="77" y="155">55</text>
        </g>

        {/* Diş 61 - Üst çene ön orta (sağ) */}
        <g id="milk-tooth-61" className="milk-tooth-group">
          <path
            onClick={handleToothClick}
            d="m 157.18596,113.37524 c -0.0372,0.31136 -2.03838,3.51786 -2.54294,4.9663 -0.6822,1.56367 -1.76853,2.97726 -4.66113,3.72006 -2.36193,-0.26358 -4.75744,-0.31994 -6.74559,-2.88856 l -4.88802,-6.73611 -0.89133,-2.14285 c -0.64364,-1.54722 0.75021,-2.96997 2.05513,-3.57982 l 3.5383,-0.85742 c 2.0666,-0.1203 3.43827,-0.67078 7.47617,0.42903 l 3.78887,0.7507 c 1.37832,0.55227 3.21888,0.3361 3.25466,3.12031 -0.0725,1.06423 0.38632,2.04669 -0.38412,3.21836 z"
          />
          <text x="148" y="105">61</text>
        </g>

        {/* Diş 62 - Üst çene ön yan (sağ) */}
        <g id="milk-tooth-62" className="milk-tooth-group">
          <path
            onClick={handleToothClick}
            d="m 171.46579,116.16246 c -7.26885,-5.12134 -5.77969,-3.6265 -8.89074,-4.76501 -1.08442,-0.41599 -1.98459,-0.47815 -2.44213,0.30939 l -1.68688,1.81986 c -1.14633,1.54619 -1.07002,1.87443 -1.21553,2.42363 -0.54002,4.781 0.0841,4.72099 0.20441,6.75586 0.83124,1.73196 1.83506,3.27773 3.53342,4.07416 1.04808,0.79357 2.49943,0.71568 4.04124,0.44247 l 2.53533,-0.66262 c 0.994,0.16044 1.85046,-0.55112 2.72196,-1.16735 1.83919,-1.38559 2.3145,-3.35226 2.94688,-5.25208 0.1272,-1.22877 -0.19854,-2.31724 -0.94759,-3.27469 z"
          />
          <text x="167" y="108">62</text>
        </g>

        {/* Diş 63 - Üst çene köpek dişi (sağ) */}
        <g id="milk-tooth-63" className="milk-tooth-group">
          <path
            onClick={handleToothClick}
            d="m 190.54157,135.47822 c 3.08307,-0.93464 4.52683,-2.64457 4.85452,-4.88239 0.38088,-2.18804 -0.0399,-4.32208 -1.49376,-6.38661 -1.27151,-3.21521 -2.53322,-3.03715 -3.79603,-3.2531 -1.12648,0.12907 -2.15034,0.0704 -3.14743,-0.0373 -3.01397,-0.12136 -4.13673,1.12063 -4.86302,1.93308 -2.54327,3.09458 -2.26245,4.8977 -2.88098,7.11208 -0.31814,2.44499 -0.1778,4.53561 1.19657,5.6723 4.18185,2.8421 4.8927,1.44955 6.64278,1.32481 3.25904,-1.24723 2.42081,-1.02304 3.48735,-1.48295 z"
          />
          <text x="188" y="125">63</text>
        </g>

        {/* Diş 64 - Üst çene 1. azı (sağ) */}
        <g id="milk-tooth-64" className="milk-tooth-group">
          <path
            onClick={handleToothClick}
            d="m 204.13326,136.7995 c -5.64889,-4.45518 -9.81343,-1.88188 -13.9782,0.69034 -1.12468,1.2682 -2.22493,2.53633 -3.76533,3.80544 -4.71703,4.11933 -3.82979,6.91485 -1.09811,9.27481 1.70252,1.71635 3.33311,3.40022 4.19165,4.73561 0.98398,0.92063 1.88868,1.6269 2.65707,1.96491 3.63626,1.48373 5.02457,-0.58557 7.06579,-1.62299 7.33365,-3.51232 9.95994,-8.405 8.07287,-14.62107 -0.20794,-2.39649 -1.44836,-3.58014 -3.14574,-4.22705 z"
          />
          <text x="195" y="135">64</text>
        </g>

        {/* Diş 65 - Üst çene 2. azı (sağ) */}
        <g id="milk-tooth-65" className="milk-tooth-group">
          <path
            onClick={handleToothClick}
            d="m 220.48885,155.31879 c -5.91113,-2.30027 -7.87074,-1.98736 -11.89563,-0.98768 l -6.73509,2.38655 c -0.95075,0.39286 -1.8836,0.50769 -2.51156,1.16735 -2.14779,1.24734 -2.9142,2.20877 -3.52665,3.42845 -1.3686,3.82974 -0.15838,4.68516 0.27605,6.46692 l 2.00438,3.25309 c 0.69847,1.17167 1.08442,2.20877 1.9331,3.25309 1.30209,1.60263 2.3145,3.35226 4.66113,3.61584 1.77519,0.2021 3.74017,-0.13748 5.5858,-0.27605 l 5.24602,-2.10998 c 3.16502,-1.56367 4.13666,-3.09457 4.52203,-6.32607 0.38593,-3.23151 -0.66993,-5.80335 -2.51156,-7.38822 -1.84162,-1.58487 -3.74017,-2.44502 -5.99735,-2.79299 -0.88574,-0.13748 -2.3145,-0.34497 -2.79299,-1.40895 z"
          />
          <text x="212" y="155">65</text>
        </g>

        {/* Alt çene süt dişleri */}
        
        {/* Diş 85 - Alt çene 2. azı (sol) */}
        <g id="milk-tooth-85" className="milk-tooth-group">
          <path
            onClick={handleToothClick}
            d="m 92.918039,199.57096 c 5.189319,3.15261 5.113713,4.8478 5.2705,7.25336 -0.392855,2.88121 -0.28794,3.95306 -0.275792,5.36194 0.07019,2.96176 -1.439077,3.74019 -2.390045,5.29043 -3.049451,3.72956 -4.674063,2.52422 -6.825701,3.14422 -1.978616,-0.37253 -3.184305,-0.74254 -4.332149,-1.11234 -3.226667,-0.95732 -2.944671,-2.43932 -4.168028,-3.6962 -1.568502,-2.57262 -1.706341,-5.85989 -0.878005,-9.6299 0.679285,-2.24279 2.057877,-3.92008 3.500623,-5.54541 l 3.546321,-2.18545 c 2.722498,-1.37593 5.841551,0.51294 6.552276,1.11935 z"
          />
          <text x="85" y="217">85</text>
        </g>

        {/* Diş 84 - Alt çene 1. azı (sol) */}
        <g id="milk-tooth-84" className="milk-tooth-group">
          <path
            onClick={handleToothClick}
            d="m 92.024272,221.98833 c -2.057804,3.46842 -2.551663,5.95651 -2.342996,8.00434 0.615559,3.563 0.934165,7.38685 3.998519,8.79993 4.890397,1.99163 5.943042,0.33877 7.929975,-0.42683 2.27359,-1.35118 4.06144,-3.04368 5.34979,-5.08725 0.99076,-0.83673 0.91674,-1.67692 0.95686,-2.51681 -0.15305,-1.56021 0.12159,-2.61346 0.21976,-3.87599 0.14961,-2.44867 -0.71508,-4.15779 -1.20263,-6.14194 -1.44195,-1.43501 -2.49839,-3.40574 -4.85551,-3.56913 l -4.069961,-0.14226 c -2.507029,-0.16062 -4.217119,2.49768 -5.983807,4.95594 z"
          />
          <text x="95" y="240">84</text>
        </g>

        {/* Diş 83 - Alt çene köpek dişi (sol) */}
        <g id="milk-tooth-83" className="milk-tooth-group">
          <path
            onClick={handleToothClick}
            d="m 109.28374,234.06128 c 3.53711,-0.60746 6.63297,-0.62739 7.23611,2.67224 l 1.78342,6.46692 c 1.28209,4.92896 -0.0641,3.93131 -0.27605,5.49109 l -2.65119,3.80359 c -1.01316,1.25357 -2.10481,2.43963 -4.49847,2.50547 -3.50957,-0.15869 -7.06062,-0.22658 -7.80961,-6.42158 l -0.30161,-7.23747 c 0.72778,-3.45821 1.52436,-6.86736 6.5174,-7.28026 z"
          />
          <text x="110" y="250">83</text>
        </g>

        {/* Diş 82 - Alt çene ön yan (sol) */}
        <g id="milk-tooth-82" className="milk-tooth-group">
          <path
            onClick={handleToothClick}
            d="m 128.13274,244.39491 c -1.00456,-3.42909 -3.45758,-3.46836 -5.12358,-1.82555 l -2.38655,3.67521 -2.80866,3.28622 c -0.40838,1.5381 -1.50708,1.44328 -0.22638,6.97731 0.77014,2.99338 2.3191,4.33094 4.21828,4.92394 2.43561,0.85503 4.52094,0.30542 6.39837,-1.07794 1.27981,-1.6116 3.30567,-2.37213 2.76177,-6.06456 -0.54286,-1.66058 -0.56866,-2.04881 -1.73323,-5.23911 -0.36667,-1.545 -0.73509,-2.30654 -1.10002,-4.65552 z"
          />
          <text x="125" y="265">82</text>
        </g>

        {/* Diş 81 - Alt çene ön orta (sol) */}
        <g id="milk-tooth-81" className="milk-tooth-group">
          <path
            onClick={handleToothClick}
            d="m 134.25341,249.5834 c -0.79665,2.13912 -1.36102,4.50647 -2.81448,5.99982 -0.65207,0.79867 -1.21341,1.8206 -0.48858,6.00735 0.7523,1.74435 2.04033,2.76485 4.06425,2.79131 1.63241,-0.37512 3.03762,-0.9098 5.6045,-0.62821 1.23591,-0.36501 2.3624,0.12448 3.86374,-2.31361 0.49589,-1.15152 1.26818,-1.88482 0.0122,-5.68579 l -3.84536,-6.27961 c -1.04325,-0.94977 -1.15735,-2.41216 -3.58891,-2.59603 -1.90139,0.0711 -2.25789,1.47082 -2.80736,2.70477 z"
          />
          <text x="140" y="270">81</text>
        </g>

        {/* Diş 71 - Alt çene ön orta (sağ) */}
        <g id="milk-tooth-71" className="milk-tooth-group">
          <path
            onClick={handleToothClick}
            d="m 157.75276,249.5834 c 0.79665,2.13912 1.36102,4.50647 2.81448,5.99982 0.65207,0.79867 1.21341,1.8206 0.48858,6.00735 -0.7523,1.74435 -2.04033,2.76485 -4.06425,2.79131 -1.63241,-0.37512 -3.03762,-0.9098 -5.6045,-0.62821 -1.23591,-0.36501 -2.3624,0.12448 -3.86374,-2.31361 -0.49589,-1.15152 -1.26818,-1.88482 -0.0122,-5.68579 l 3.84536,-6.27961 c 1.04325,-0.94977 1.15735,-2.41216 3.58891,-2.59603 1.90139,0.0711 2.25789,1.47082 2.80736,2.70477 z"
          />
          <text x="152" y="270">71</text>
        </g>

        {/* Diş 72 - Alt çene ön yan (sağ) */}
        <g id="milk-tooth-72" className="milk-tooth-group">
          <path
            onClick={handleToothClick}
            d="m 163.87343,244.39491 c 1.00456,-3.42909 3.45758,-3.46836 5.12358,-1.82555 l 2.38655,3.67521 2.80866,3.28622 c 0.40838,1.5381 1.50708,1.44328 0.22638,6.97731 -0.77014,2.99338 -2.3191,4.33094 -4.21828,4.92394 -2.43561,0.85503 -4.52094,0.30542 -6.39837,-1.07794 -1.27981,-1.6116 -3.30567,-2.37213 -2.76177,-6.06456 0.54286,-1.66058 0.56866,-2.04881 1.73323,-5.23911 0.36667,-1.545 0.73509,-2.30654 1.10002,-4.65552 z"
          />
          <text x="167" y="265">72</text>
        </g>

        {/* Diş 73 - Alt çene köpek dişi (sağ) */}
        <g id="milk-tooth-73" className="milk-tooth-group">
          <path
            onClick={handleToothClick}
            d="m 182.72243,234.06128 c -3.53711,-0.60746 -6.63297,-0.62739 -7.23611,2.67224 l -1.78342,6.46692 c -1.28209,4.92896 0.0641,3.93131 0.27605,5.49109 l 2.65119,3.80359 c 1.01316,1.25357 2.10481,2.43963 4.49847,2.50547 3.50957,-0.15869 7.06062,-0.22658 7.80961,-6.42158 l 0.30161,-7.23747 c -0.72778,-3.45821 -1.52436,-6.86736 -6.5174,-7.28026 z"
          />
          <text x="182" y="250">73</text>
        </g>

        {/* Diş 74 - Alt çene 1. azı (sağ) */}
        <g id="milk-tooth-74" className="milk-tooth-group">
          <path
            onClick={handleToothClick}
            d="m 199.98189,221.98833 c 2.0578,3.46842 2.55166,5.95651 2.343,8.00434 -0.61556,3.563 -0.93417,7.38685 -3.99852,8.79993 -4.8904,1.99163 -5.94304,0.33877 -7.92998,-0.42683 -2.27359,-1.35118 -4.06144,-3.04368 -5.34979,-5.08725 -0.99076,-0.83673 -0.91674,-1.67692 -0.95686,-2.51681 0.15305,-1.56021 -0.12159,-2.61346 -0.21976,-3.87599 -0.14961,-2.44867 0.71508,-4.15779 1.20263,-6.14194 1.44195,-1.43501 2.49839,-3.40574 4.85551,-3.56913 l 4.06996,-0.14226 c 2.50703,-0.16062 4.21712,2.49768 5.98381,4.95594 z"
          />
          <text x="195" y="240">74</text>
        </g>

        {/* Diş 75 - Alt çene 2. azı (sağ) */}
        <g id="milk-tooth-75" className="milk-tooth-group">
          <path
            onClick={handleToothClick}
            d="m 198.383,199.60633 c -5.18932,3.15259 -5.11371,4.8478 -5.27049,7.25337 0.39286,2.88118 0.28796,3.95303 0.2758,5.36194 -0.0701,2.96167 1.43908,3.74017 2.39004,5.29043 3.04952,3.72954 4.67406,2.52421 6.82572,3.14421 1.97858,-0.3725 3.18428,-0.74255 4.33214,-1.11233 3.22667,-0.95734 2.94466,-2.4393 4.168,-3.69621 1.5685,-2.57261 1.70637,-5.85991 0.87803,-9.62991 -0.67928,-2.24278 -2.05789,-3.92006 -3.50063,-5.54542 l -3.54634,-2.18544 c -2.72247,-1.3759 -5.84154,0.51296 -6.55227,1.11936 z"
          />
          <text x="207" y="217">75</text>
        </g>
      </svg>
    </div>
  );
}
